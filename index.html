<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>ğŸŒ¸ My Slambook</title>
<link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600;700&family=Josefin+Sans:wght@300;400;600&family=Abril+Fatface&family=Dancing+Script:wght@500;700&family=Pacifico&family=Quicksand:wght@400;600&family=Satisfy&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Raleway:wght@300;400;600&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#FFF8F0;--bg2:rgba(232,213,245,.55);--bg3:rgba(255,214,224,.5);--bg4:rgba(200,240,224,.3);
  --paper:#FFFDF8;--spine1:#EDBED0;--spine2:#D4A0B0;--card-border:#D4B5C0;
  --accent:#FF8B6B;--accent2:#FF6190;--ink:#2D1B4E;--soft-ink:#6B5B8A;--muted:rgba(107,91,138,.3);
  --c1:#FFD6E0;--c2:#E8D5F5;--c3:#C8F0E0;--c4:#B8C5F5;--c5:#FFD6A5;
  --rapid-bg:#E8D5F5;--shadow:rgba(45,27,78,.12);--tag-bg:#E8D5F5;
  --header-bg:white;--line-color:rgba(180,160,200,.18);
  --font-body:'Josefin Sans',sans-serif;--font-hand:'Caveat',cursive;--font-display:'Abril Fatface',serif;
}
.theme-midnight{--bg:#0F0C1A;--bg2:rgba(88,60,140,.35);--bg3:rgba(60,40,100,.3);--bg4:rgba(30,60,100,.25);--paper:#1A1430;--spine1:#3D2B6E;--spine2:#2D1F55;--card-border:#4A3580;--accent:#A78BFA;--accent2:#7C3AED;--ink:#EDE9FF;--soft-ink:#A89CC8;--muted:rgba(168,156,200,.3);--c1:#2D1F55;--c2:#1E1640;--c3:#1A2845;--c4:#251840;--c5:#2A1A35;--rapid-bg:#251840;--shadow:rgba(0,0,0,.5);--tag-bg:#3D2B6E;--header-bg:#120E22;--line-color:rgba(100,80,160,.2);}
.theme-ocean{--bg:#EAF6FF;--bg2:rgba(147,210,255,.4);--bg3:rgba(100,180,240,.3);--bg4:rgba(180,230,220,.3);--paper:#F5FBFF;--spine1:#7EC8E3;--spine2:#4AACCC;--card-border:#7EC8E3;--accent:#0284C7;--accent2:#0EA5E9;--ink:#0C2D48;--soft-ink:#2E6B8A;--muted:rgba(46,107,138,.3);--c1:#BAE6FD;--c2:#A5F3FC;--c3:#B2F5EA;--c4:#BFDBFE;--c5:#DDD6FE;--rapid-bg:#BAE6FD;--shadow:rgba(12,45,72,.12);--tag-bg:#BAE6FD;--header-bg:white;--line-color:rgba(100,180,220,.18);}
.theme-forest{--bg:#F0F7F0;--bg2:rgba(134,197,134,.3);--bg3:rgba(100,180,100,.25);--bg4:rgba(200,230,160,.3);--paper:#F8FCF8;--spine1:#A8D5A2;--spine2:#7BBF76;--card-border:#A8D5A2;--accent:#2D7A2D;--accent2:#48A848;--ink:#1A3A1A;--soft-ink:#4A7A4A;--muted:rgba(74,122,74,.3);--c1:#D1FAE5;--c2:#BBF7D0;--c3:#A7F3D0;--c4:#DCFCE7;--c5:#F0FDF4;--rapid-bg:#D1FAE5;--shadow:rgba(26,58,26,.12);--tag-bg:#BBF7D0;--header-bg:white;--line-color:rgba(100,160,100,.18);}
.theme-sunset{--bg:#FFF5EE;--bg2:rgba(255,160,80,.3);--bg3:rgba(255,100,60,.25);--bg4:rgba(255,200,100,.3);--paper:#FFFAF5;--spine1:#FFB07C;--spine2:#FF8C42;--card-border:#FFB07C;--accent:#E85D04;--accent2:#F48C06;--ink:#3D1A00;--soft-ink:#8B4500;--muted:rgba(139,69,0,.3);--c1:#FED7AA;--c2:#FDE68A;--c3:#FCA5A5;--c4:#FDBA74;--c5:#FEF3C7;--rapid-bg:#FED7AA;--shadow:rgba(61,26,0,.12);--tag-bg:#FDE68A;--header-bg:white;--line-color:rgba(200,100,40,.15);}
.theme-candy{--bg:#FFF0F8;--bg2:rgba(255,150,220,.3);--bg3:rgba(255,100,200,.25);--bg4:rgba(200,150,255,.3);--paper:#FFF8FC;--spine1:#FFB3D9;--spine2:#FF80C0;--card-border:#FFB3D9;--accent:#E91E8C;--accent2:#FF4DB8;--ink:#3D0030;--soft-ink:#8B1060;--muted:rgba(139,16,96,.3);--c1:#FBCFE8;--c2:#F5D0FE;--c3:#DDD6FE;--c4:#FDE2F3;--c5:#FCE7F3;--rapid-bg:#F5D0FE;--shadow:rgba(61,0,48,.12);--tag-bg:#FBCFE8;--header-bg:white;--line-color:rgba(200,80,160,.15);}
.theme-darkrose{--bg:#1A0A0F;--bg2:rgba(180,40,80,.25);--bg3:rgba(140,20,60,.2);--bg4:rgba(80,10,30,.2);--paper:#250D16;--spine1:#7A1F3D;--spine2:#5A1530;--card-border:#7A1F3D;--accent:#F43F6A;--accent2:#E11D48;--ink:#FFE0EA;--soft-ink:#C9889A;--muted:rgba(201,136,154,.3);--c1:#4C1027;--c2:#3D0A1E;--c3:#2D1020;--c4:#3A0A1A;--c5:#421228;--rapid-bg:#3D0A1E;--shadow:rgba(0,0,0,.5);--tag-bg:#4C1027;--header-bg:#140609;--line-color:rgba(180,40,80,.2);}

*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);font-family:var(--font-body);min-height:100vh;overflow-x:hidden;transition:background .4s,color .4s;}
.bg-scene{position:fixed;inset:0;z-index:0;background:radial-gradient(ellipse 80% 50% at 20% 20%,var(--bg2),transparent),radial-gradient(ellipse 60% 40% at 80% 80%,var(--bg3),transparent),radial-gradient(ellipse 50% 60% at 50% 50%,var(--bg4),transparent),var(--bg);transition:background .4s;}
.bg-scene::before{content:'';position:absolute;inset:0;background-image:repeating-linear-gradient(transparent,transparent 39px,var(--line-color) 39px,var(--line-color) 40px);pointer-events:none;}
.floaty{position:fixed;pointer-events:none;z-index:1;font-size:1.8rem;animation:floaty 16s ease-in-out infinite;opacity:.45;}
@keyframes floaty{0%,100%{transform:translateY(0) rotate(-4deg);}50%{transform:translateY(-18px) rotate(5deg);}}
.page{display:none;min-height:100vh;position:relative;z-index:10;}
.page.active{display:flex;flex-direction:column;}
#authPage{align-items:center;justify-content:flex-start;padding:24px 16px 40px;}

/* AUTH + THEME SIDE BY SIDE */
.auth-wrap{width:100%;max-width:860px;display:flex;gap:20px;align-items:flex-start;flex-wrap:wrap;justify-content:center;}

.auth-book{background:var(--paper);border-radius:4px 20px 20px 4px;width:100%;max-width:440px;flex-shrink:0;box-shadow:-4px 0 0 var(--card-border),8px 8px 40px var(--shadow),-2px 0 0 var(--spine2);position:relative;overflow:hidden;animation:bookIn .7s cubic-bezier(.34,1.56,.64,1) both;transition:background .4s,box-shadow .4s;}
@keyframes bookIn{from{transform:scale(.82) rotateY(-10deg);opacity:0;}to{transform:scale(1) rotateY(0);opacity:1;}}
.auth-book::before{content:'';position:absolute;left:0;top:0;bottom:0;width:34px;background:linear-gradient(180deg,var(--spine1),var(--spine2) 45%,var(--spine1));border-right:1.5px solid rgba(255,255,255,.35);z-index:1;}
.auth-book::after{content:'';position:absolute;inset:0;pointer-events:none;background-image:repeating-linear-gradient(transparent,transparent 31px,var(--line-color) 31px,var(--line-color) 32px);}
.auth-inner{padding:32px 30px 30px 52px;position:relative;z-index:2;}
.auth-logo{font-family:var(--font-display);font-size:2.1rem;color:var(--ink);line-height:1;margin-bottom:2px;transition:color .4s;}
.auth-logo em{color:var(--accent);font-style:normal;}
.auth-tagline{font-family:var(--font-hand);font-size:.95rem;color:var(--soft-ink);margin-bottom:18px;}
.auth-tabs{display:flex;border-bottom:2px solid var(--c1);margin-bottom:18px;}
.tab-btn{flex:1;padding:8px;background:none;border:none;font-family:var(--font-body);font-size:.73rem;letter-spacing:2px;text-transform:uppercase;color:var(--soft-ink);cursor:pointer;border-bottom:2px solid transparent;margin-bottom:-2px;transition:all .2s;}
.tab-btn.active{color:var(--accent);border-bottom-color:var(--accent);}
.auth-form{display:none;animation:fadeUp .3s ease both;}
.auth-form.active{display:block;}
@keyframes fadeUp{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}
.fg{margin-bottom:13px;}
.fg label{display:block;font-size:.67rem;letter-spacing:1.8px;text-transform:uppercase;color:var(--soft-ink);margin-bottom:5px;}
.fg input{width:100%;padding:9px 13px;background:rgba(255,255,255,.08);border:1.5px solid rgba(180,160,200,.28);border-radius:9px;font-family:var(--font-hand);font-size:1.08rem;color:var(--ink);outline:none;transition:border-color .2s,box-shadow .2s,background .2s;}
.fg input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(255,139,107,.12);background:rgba(255,255,255,.15);}
.fg input::placeholder{color:var(--muted);font-style:italic;}
.err-msg{font-size:.73rem;color:#e05a5a;margin-top:3px;min-height:16px;}
.disclaimer{margin-top:10px;padding:9px 13px;background:rgba(255,180,50,.1);border:1.5px solid rgba(255,150,30,.25);border-radius:8px;font-size:.71rem;color:var(--soft-ink);line-height:1.6;}
.disclaimer strong{color:var(--accent);}
.auth-btn{width:100%;padding:11px;margin-top:8px;background:linear-gradient(135deg,var(--accent),var(--accent2));border:none;border-radius:10px;font-family:var(--font-hand);font-size:1.2rem;letter-spacing:.5px;color:white;cursor:pointer;box-shadow:0 4px 20px rgba(0,0,0,.18);transition:transform .15s,box-shadow .15s;}
.auth-btn:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(0,0,0,.24);}
.auth-btn:active{transform:translateY(1px);}
.auth-btn:disabled{opacity:.5;cursor:not-allowed;transform:none;}

/* THEME SIDEBAR */
.theme-sidebar{width:100%;max-width:380px;background:var(--paper);border-radius:16px;padding:22px 18px;box-shadow:4px 4px 24px var(--shadow);animation:sideIn .8s cubic-bezier(.34,1.2,.64,1) both .1s;transition:background .4s;}
@keyframes sideIn{from{transform:translateX(20px);opacity:0;}to{transform:translateX(0);opacity:1;}}
.ts-title{font-family:var(--font-hand);font-size:1.5rem;color:var(--ink);margin-bottom:16px;}
.ts-lbl{font-size:.66rem;letter-spacing:2px;text-transform:uppercase;color:var(--soft-ink);margin-bottom:9px;margin-top:16px;display:block;}
.ts-lbl:first-of-type{margin-top:0;}
.theme-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:7px;}
.t-swatch{border-radius:10px;padding:8px 4px;text-align:center;cursor:pointer;border:2px solid transparent;transition:transform .15s,border-color .2s;font-size:.62rem;color:var(--ink);background:var(--bg);}
.t-swatch:hover{transform:scale(1.06);}
.t-swatch.active{border-color:var(--accent);transform:scale(1.08);}
.t-dot{width:26px;height:26px;border-radius:50%;margin:0 auto 4px;box-shadow:0 2px 6px rgba(0,0,0,.15);}
.font-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;}
.f-card{padding:10px 12px;border-radius:10px;background:var(--bg);border:2px solid transparent;cursor:pointer;transition:all .15s;}
.f-card:hover{border-color:var(--c2);}
.f-card.active{border-color:var(--accent);background:var(--c1);}
.f-name{font-size:.63rem;letter-spacing:1.2px;text-transform:uppercase;color:var(--soft-ink);margin-bottom:3px;}
.f-prev{font-size:1.1rem;color:var(--ink);}

/* DASHBOARD */
.dash-hdr{background:var(--header-bg);padding:13px 26px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 2px 18px var(--shadow);position:sticky;top:0;z-index:50;transition:background .4s;}
.dash-logo{font-family:var(--font-display);font-size:1.5rem;color:var(--ink);}
.dash-logo em{color:var(--accent);font-style:normal;}
.hdr-right{display:flex;align-items:center;gap:10px;}
.avatar{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,var(--c2),var(--c1));display:flex;align-items:center;justify-content:center;font-family:var(--font-hand);font-weight:700;font-size:.95rem;color:var(--ink);}
.uname-lbl{font-size:.8rem;color:var(--soft-ink);letter-spacing:.8px;}
.hdr-btn{padding:6px 14px;border:1.5px solid var(--c1);border-radius:20px;background:none;font-family:var(--font-body);font-size:.72rem;letter-spacing:1px;color:var(--soft-ink);cursor:pointer;transition:all .2s;}
.hdr-btn:hover{background:var(--c1);color:var(--ink);}
.dash-body{flex:1;padding:26px;max-width:980px;margin:0 auto;width:100%;}
.link-card{background:var(--paper);border-radius:18px;padding:24px;margin-bottom:26px;box-shadow:0 4px 22px var(--shadow);border:1.5px dashed rgba(180,160,200,.28);position:relative;overflow:hidden;transition:background .4s;}
.link-card::after{content:'ğŸ“®';position:absolute;top:-6px;right:16px;font-size:2.8rem;opacity:.1;pointer-events:none;}
.link-card h3{font-family:var(--font-hand);font-size:1.4rem;color:var(--ink);margin-bottom:4px;}
.link-card p{font-size:.76rem;color:var(--soft-ink);margin-bottom:13px;}
.link-row{display:flex;gap:10px;align-items:center;background:var(--bg);border-radius:10px;padding:10px 14px;border:1px solid rgba(180,160,200,.2);}
.link-row span{font-family:var(--font-hand);font-size:.94rem;color:var(--accent);flex:1;word-break:break-all;}
.copy-btn{padding:7px 15px;background:linear-gradient(135deg,var(--accent),var(--accent2));border:none;border-radius:8px;font-family:var(--font-body);font-size:.71rem;letter-spacing:1px;color:white;cursor:pointer;white-space:nowrap;transition:transform .15s;}
.copy-btn:hover{transform:scale(1.05);}
.sec-head{font-family:var(--font-hand);font-size:1.6rem;color:var(--ink);margin-bottom:16px;display:flex;align-items:center;gap:10px;}
.sec-head::after{content:'';flex:1;height:1px;background:linear-gradient(90deg,var(--c2),transparent);}
.r-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(255px,1fr));gap:18px;}
.r-card{background:var(--paper);border-radius:14px;padding:20px;box-shadow:4px 4px 18px var(--shadow);cursor:pointer;transition:transform .22s,box-shadow .22s,background .4s;position:relative;border-top:3px solid var(--c1);opacity:0;transform:translateY(14px);animation:cardIn .4s ease forwards;}
.r-card:hover{transform:translateY(-5px) rotate(.4deg);box-shadow:6px 8px 28px var(--shadow);}
@keyframes cardIn{to{opacity:1;transform:translateY(0);}}
.r-card .stk{position:absolute;top:-13px;right:12px;font-size:1.7rem;animation:wobble 3.5s ease-in-out infinite;}
@keyframes wobble{0%,100%{transform:rotate(-6deg);}50%{transform:rotate(8deg);}}
.rn{font-family:var(--font-hand);font-size:1.35rem;color:var(--ink);margin-bottom:2px;}
.rk{font-size:.72rem;color:var(--soft-ink);letter-spacing:.9px;margin-bottom:8px;}
.rp{font-size:.78rem;color:var(--soft-ink);line-height:1.6;font-style:italic;}
.rb{display:inline-block;padding:3px 10px;border-radius:20px;background:var(--tag-bg);font-size:.63rem;letter-spacing:1px;color:var(--soft-ink);margin-top:6px;}
.rt{font-size:.63rem;color:var(--muted);margin-top:8px;}
.del-btn{position:absolute;bottom:12px;right:12px;width:28px;height:28px;border-radius:50%;background:rgba(220,50,50,.08);border:1.5px solid rgba(220,50,50,.2);color:#e05a5a;font-size:.85rem;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;opacity:0;}
.r-card:hover .del-btn{opacity:1;}
.del-btn:hover{background:#ffe0e0;border-color:#e05a5a;transform:scale(1.15);}
.r-card.deleting{animation:cardOut .35s ease forwards;}
@keyframes cardOut{to{opacity:0;transform:scale(.85) translateY(-8px);}}
.empty-state{text-align:center;padding:50px 20px;grid-column:1/-1;}
.empty-state .em{font-size:3.2rem;display:block;margin-bottom:14px;}
.empty-state h4{font-family:var(--font-hand);font-size:1.4rem;color:var(--ink);margin-bottom:6px;}
.empty-state p{font-size:.78rem;color:var(--soft-ink);}
#toast{position:fixed;bottom:28px;left:50%;transform:translateX(-50%) translateY(16px);background:var(--ink);color:var(--bg);font-family:var(--font-hand);font-size:1.1rem;padding:12px 28px;border-radius:50px;z-index:9999;opacity:0;transition:all .3s;pointer-events:none;}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
#modal{position:fixed;inset:0;z-index:1000;background:rgba(0,0,0,.45);backdrop-filter:blur(8px);display:none;align-items:center;justify-content:center;padding:16px;}
#modal.open{display:flex;}
.m-book{background:var(--paper);border-radius:4px 20px 20px 4px;max-width:680px;width:100%;max-height:90vh;overflow-y:auto;box-shadow:-4px 0 0 var(--card-border),8px 8px 48px var(--shadow);animation:mIn .4s cubic-bezier(.34,1.56,.64,1);transition:background .4s;}
.m-book::-webkit-scrollbar{width:4px;}
.m-book::-webkit-scrollbar-thumb{background:var(--c1);border-radius:2px;}
@keyframes mIn{from{transform:scale(.84);opacity:0;}to{transform:scale(1);opacity:1;}}
.m-spine{position:sticky;top:0;z-index:2;display:flex;align-items:center;justify-content:space-between;padding:18px 24px;background:linear-gradient(135deg,var(--c2),var(--c1));border-radius:0 20px 0 0;}
.m-title{font-family:var(--font-hand);font-size:1.9rem;color:var(--ink);}
.m-close{width:30px;height:30px;border-radius:50%;background:white;border:none;cursor:pointer;font-size:1.1rem;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 10px var(--shadow);transition:transform .2s;}
.m-close:hover{transform:scale(1.12);}
.m-body{padding:24px;}
.qs{margin-bottom:24px;}
.qs-title{font-family:var(--font-hand);font-size:1.15rem;color:var(--accent);border-bottom:1.5px dashed rgba(180,160,200,.3);padding-bottom:5px;margin-bottom:12px;}
.qrow{margin-bottom:9px;padding-bottom:9px;border-bottom:1px solid var(--line-color);}
.ql{font-size:.67rem;letter-spacing:1.4px;text-transform:uppercase;color:var(--soft-ink);}
.qv{font-family:var(--font-hand);font-size:1.08rem;color:var(--ink);line-height:1.4;}
.qv.empty{color:var(--muted);font-style:italic;font-size:.88rem;}
.rf-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;}
.rfi{background:var(--rapid-bg);border-radius:8px;padding:9px 13px;transition:background .4s;}
.m-print{margin:0 24px 24px;width:calc(100% - 48px);padding:10px;background:var(--c3);border:none;border-radius:10px;font-family:var(--font-hand);font-size:1.05rem;color:var(--ink);cursor:pointer;transition:transform .15s;display:block;}
.m-print:hover{transform:scale(1.02);}
#confirmBox{position:fixed;inset:0;z-index:2000;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.4);backdrop-filter:blur(6px);}
#confirmBox.open{display:flex;}
.confirm-card{background:var(--paper);border-radius:18px;padding:30px 26px;max-width:330px;width:90%;text-align:center;box-shadow:0 8px 40px var(--shadow);animation:popIn .3s cubic-bezier(.34,1.56,.64,1);}
@keyframes popIn{from{transform:scale(.8);opacity:0;}to{transform:scale(1);opacity:1;}}
.confirm-emoji{font-size:2.4rem;display:block;margin-bottom:10px;}
.confirm-title{font-family:var(--font-hand);font-size:1.45rem;color:var(--ink);margin-bottom:6px;}
.confirm-sub{font-size:.78rem;color:var(--soft-ink);margin-bottom:20px;line-height:1.5;}
.confirm-btns{display:flex;gap:10px;justify-content:center;}
.confirm-yes{padding:9px 22px;border-radius:20px;border:none;background:linear-gradient(135deg,#FF6B6B,#e03c3c);font-family:var(--font-hand);font-size:1.05rem;color:white;cursor:pointer;transition:transform .15s;}
.confirm-yes:hover{transform:scale(1.05);}
.confirm-no{padding:9px 22px;border-radius:20px;border:1.5px solid var(--c1);background:none;font-family:var(--font-hand);font-size:1.05rem;color:var(--soft-ink);cursor:pointer;transition:all .15s;}
.confirm-no:hover{background:var(--c1);}
@media(max-width:600px){.auth-wrap{flex-direction:column;}.theme-sidebar{max-width:440px;}}
</style>
</head>
<body>
<div class="bg-scene"></div>
<span class="floaty" style="top:10%;right:7%;animation-delay:0s;">ğŸŒ¸</span>
<span class="floaty" style="bottom:18%;left:4%;animation-delay:-5s;">âœ¨</span>
<span class="floaty" style="top:55%;right:3%;animation-delay:-10s;">ğŸ’Œ</span>
<span class="floaty" style="top:32%;left:7%;animation-delay:-3s;">ğŸ¦‹</span>

<!-- AUTH PAGE -->
<div class="page active" id="authPage">
  <div class="auth-wrap">
    <div class="auth-book">
      <div class="auth-inner">
        <div class="auth-logo">My <em>Slambook</em> ğŸ““</div>
        <div class="auth-tagline">where friends leave their mark âœ¨</div>
        <div class="auth-tabs">
          <button class="tab-btn active" onclick="switchTab('login')">Sign In</button>
          <button class="tab-btn" onclick="switchTab('register')">Create Book</button>
        </div>
        <!-- LOGIN -->
        <div class="auth-form active" id="loginForm">
          <div class="fg"><label>Username</label>
            <input type="text" id="lUser" placeholder="your name hereâ€¦" autocomplete="username"/></div>
          <div class="fg"><label>Password</label>
            <input type="password" id="lPass" placeholder="shhh ğŸ¤«" autocomplete="current-password"/></div>
          <div class="err-msg" id="lErr"></div>
          <button class="auth-btn" id="lBtn" onclick="handleLogin()">Open My Slambook ğŸ“–</button>
        </div>
        <!-- REGISTER -->
        <div class="auth-form" id="registerForm">
          <div class="fg"><label>Username</label>
            <input type="text" id="rUser" placeholder="what do friends call you?"/></div>
          <div class="fg"><label>Email</label>
            <input type="email" id="rEmail" placeholder="your@email.com" autocomplete="email"/></div>
          <div class="fg"><label>Password (6+ chars)</label>
            <input type="password" id="rPass" placeholder="make it secret ğŸ”’" autocomplete="new-password"/></div>
          <div class="err-msg" id="rErr"></div>
          <div class="disclaimer">âš ï¸ <strong>Important:</strong> Your password <strong>cannot be reset or recovered</strong> once set. There is no "Forgot Password." Please save it somewhere safe!</div>
          <button class="auth-btn" id="rBtn" onclick="handleRegister()">Create My Slambook ğŸŒ¸</button>
        </div>
      </div>
    </div>

    <!-- THEME SIDEBAR -->
    <div class="theme-sidebar">
      <div class="ts-title">ğŸ¨ Pick Your Vibe</div>
      <span class="ts-lbl">ğŸŒˆ Theme</span>
      <div class="theme-grid" id="themeGrid"></div>
      <span class="ts-lbl">âœï¸ Font</span>
      <div class="font-grid" id="fontGrid"></div>
    </div>
  </div>
</div>

<!-- DASHBOARD -->
<div class="page" id="dashPage">
  <div class="dash-hdr">
    <div class="dash-logo">My <em>Slambook</em> ğŸ““</div>
    <div class="hdr-right">
      <div class="avatar" id="av">?</div>
      <span class="uname-lbl" id="unameDisp"></span>
      <button class="hdr-btn" onclick="handleLogout()">Sign Out</button>
    </div>
  </div>
  <div class="dash-body">
    <div class="link-card">
      <h3>Share Your Slambook ğŸ’Œ</h3>
      <p>Send this link to your friends â€” they'll fill it out just for you!</p>
      <div class="link-row">
        <span id="shareLink">generatingâ€¦</span>
        <button class="copy-btn" onclick="copyLink()">ğŸ“‹ Copy</button>
      </div>
    </div>
    <div class="sec-head">ğŸ’Œ Slams I've Received</div>
    <div class="r-grid" id="rGrid">
      <div class="empty-state"><span class="em">ğŸ“­</span><h4>No slams yet!</h4><p>Share your link and wait for the love~</p></div>
    </div>
  </div>
</div>

<!-- MODAL -->
<div id="modal" onclick="maybeClose(event)">
  <div class="m-book">
    <div class="m-spine"><div class="m-title" id="mTitle"></div><button class="m-close" onclick="closeModal()">âœ•</button></div>
    <div class="m-body" id="mBody"></div>
    <button class="m-print" onclick="window.print()">ğŸ–¨ï¸ Save / Print</button>
  </div>
</div>

<!-- CONFIRM DELETE -->
<div id="confirmBox">
  <div class="confirm-card">
    <span class="confirm-emoji">ğŸ—‘ï¸</span>
    <div class="confirm-title">Delete this slam?</div>
    <div class="confirm-sub">You're about to delete <strong id="confirmName"></strong>'s entry. This can't be undone!</div>
    <div class="confirm-btns">
      <button class="confirm-yes" id="confirmYesBtn">Yes, delete</button>
      <button class="confirm-no" id="confirmNoBtn">Keep it ğŸ’Œ</button>
    </div>
  </div>
</div>
<div id="toast"></div>

<script>
/* â•â• SUPABASE CONFIG â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const SUPA_URL = 'https://axysorsklatueeefvnyp.supabase.co';
const SUPA_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF4eXNvcnNrbGF0dWVlZWZ2bnlwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIzMTk1MzAsImV4cCI6MjA4Nzg5NTUzMH0.FPKfSFiYKezU292ZA3__GFngsV14PqIM2HU9sf69L1Y';
const H = {'Content-Type':'application/json','apikey':SUPA_KEY,'Authorization':'Bearer '+SUPA_KEY};

async function sbFetch(path, opts={}){
  const r = await fetch(SUPA_URL+path, {...opts, headers:{...H,...(opts.headers||{})}});
  const d = await r.json().catch(()=>({}));
  return {ok:r.ok, status:r.status, data:d};
}

/* Auth token storage */
let sbToken = localStorage.getItem('sb_access_token') || '';
let sbRefresh = localStorage.getItem('sb_refresh_token') || '';
function setTokens(access, refresh){
  sbToken = access; sbRefresh = refresh;
  localStorage.setItem('sb_access_token', access);
  localStorage.setItem('sb_refresh_token', refresh);
  H['Authorization'] = 'Bearer ' + access;
}
function clearTokens(){
  sbToken=''; sbRefresh='';
  localStorage.removeItem('sb_access_token');
  localStorage.removeItem('sb_refresh_token');
  H['Authorization'] = 'Bearer ' + SUPA_KEY;
}
if(sbToken) H['Authorization'] = 'Bearer ' + sbToken;

/* â•â• THEMES + FONTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const THEMES=[
  {id:'',        name:'Blossom', emoji:'ğŸŒ¸', dot:'linear-gradient(135deg,#FFD6E0,#E8D5F5)'},
  {id:'midnight',name:'Midnight',emoji:'ğŸŒ™', dot:'linear-gradient(135deg,#2D1B4E,#4A3580)'},
  {id:'ocean',   name:'Ocean',   emoji:'ğŸŒŠ', dot:'linear-gradient(135deg,#BAE6FD,#0284C7)'},
  {id:'forest',  name:'Forest',  emoji:'ğŸŒ¿', dot:'linear-gradient(135deg,#D1FAE5,#2D7A2D)'},
  {id:'sunset',  name:'Sunset',  emoji:'ğŸŒ…', dot:'linear-gradient(135deg,#FED7AA,#E85D04)'},
  {id:'candy',   name:'Candy',   emoji:'ğŸ­', dot:'linear-gradient(135deg,#FBCFE8,#E91E8C)'},
  {id:'darkrose',name:'Dark Rose',emoji:'ğŸ¥€',dot:'linear-gradient(135deg,#4C1027,#F43F6A)'},
];
const FONTS=[
  {id:'caveat',   name:'Caveat',   hand:"'Caveat',cursive",         body:"'Josefin Sans',sans-serif", disp:"'Abril Fatface',serif",   prev:'Hello friend âœ¨'},
  {id:'dancing',  name:'Dancing',  hand:"'Dancing Script',cursive", body:"'Quicksand',sans-serif",    disp:"'Dancing Script',cursive",prev:'Hello friend âœ¨'},
  {id:'pacifico', name:'Pacifico', hand:"'Pacifico',cursive",       body:"'Nunito',sans-serif",       disp:"'Pacifico',cursive",      prev:'Hello friend âœ¨'},
  {id:'satisfy',  name:'Satisfy',  hand:"'Satisfy',cursive",        body:"'Raleway',sans-serif",      disp:"'Satisfy',cursive",       prev:'Hello friend âœ¨'},
  {id:'playfair', name:'Playfair', hand:"'Playfair Display',serif", body:"'Josefin Sans',sans-serif", disp:"'Playfair Display',serif",prev:'Hello friend âœ¨'},
];
let activeTheme=localStorage.getItem('sb_theme')||'';
let activeFont =localStorage.getItem('sb_font') ||'caveat';

function applyTheme(id,save=true){
  activeTheme=id;
  document.body.className=document.body.className.replace(/\btheme-\S+/g,'').trim();
  if(id) document.body.classList.add('theme-'+id);
  if(save) localStorage.setItem('sb_theme',id);
  document.querySelectorAll('.t-swatch').forEach(s=>s.classList.toggle('active',s.dataset.theme===id));
}
function applyFont(id,save=true){
  activeFont=id;
  const f=FONTS.find(x=>x.id===id)||FONTS[0];
  const r=document.documentElement;
  r.style.setProperty('--font-body',f.body);
  r.style.setProperty('--font-hand',f.hand);
  r.style.setProperty('--font-display',f.disp);
  if(save) localStorage.setItem('sb_font',id);
  document.querySelectorAll('.f-card').forEach(c=>c.classList.toggle('active',c.dataset.font===id));
}
function buildPickers(){
  const tg=document.getElementById('themeGrid'); tg.innerHTML='';
  THEMES.forEach(t=>{
    const s=document.createElement('div');
    s.className='t-swatch'+(t.id===activeTheme?' active':'');
    s.dataset.theme=t.id;
    s.innerHTML=`<div class="t-dot" style="background:${t.dot}"></div>${t.emoji} ${t.name}`;
    s.addEventListener('click',()=>applyTheme(t.id));
    tg.appendChild(s);
  });
  const fg=document.getElementById('fontGrid'); fg.innerHTML='';
  FONTS.forEach(f=>{
    const c=document.createElement('div');
    c.className='f-card'+(f.id===activeFont?' active':'');
    c.dataset.font=f.id;
    c.innerHTML=`<div class="f-name">${f.name}</div><div class="f-prev" style="font-family:${f.hand}">${f.prev}</div>`;
    c.addEventListener('click',()=>applyFont(f.id));
    fg.appendChild(c);
  });
}
applyTheme(activeTheme,false);
applyFont(activeFont,false);
buildPickers();

/* â•â• UTILS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let currentUser=null;
let currentProfile=null;

function switchTab(t){
  document.querySelectorAll('.tab-btn').forEach((b,i)=>b.classList.toggle('active',i===(t==='login'?0:1)));
  document.getElementById('loginForm').classList.toggle('active',t==='login');
  document.getElementById('registerForm').classList.toggle('active',t==='register');
}
function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
function toast(msg){
  const t=document.getElementById('toast');
  t.textContent=msg;t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),2600);
}
function showErr(id,msg){
  const el=document.getElementById(id);
  el.textContent=msg;
  setTimeout(()=>el.textContent='',4000);
}
function esc(s=''){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

/* â•â• AUTH â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function handleRegister(){
  const btn=document.getElementById('rBtn');
  const username=document.getElementById('rUser').value.trim();
  const email=document.getElementById('rEmail').value.trim();
  const password=document.getElementById('rPass').value;
  if(!username||!email||!password){showErr('rErr','Please fill in all fields');return;}
  if(username.length<3){showErr('rErr','Username must be 3+ characters');return;}
  if(password.length<6){showErr('rErr','Password must be 6+ characters');return;}
  btn.disabled=true; btn.textContent='Creatingâ€¦ ğŸŒ¸';

  /* Check username taken */
  const chk=await sbFetch(`/rest/v1/profiles?username=eq.${encodeURIComponent(username)}&select=id`);
  if(chk.ok&&chk.data.length>0){showErr('rErr','Username already taken');btn.disabled=false;btn.textContent='Create My Slambook ğŸŒ¸';return;}

  /* Sign up with Supabase Auth */
  const reg=await sbFetch('/auth/v1/signup',{method:'POST',body:JSON.stringify({email,password})});
  if(!reg.ok){
    const msg=reg.data.msg||reg.data.error_description||'Registration failed';
    showErr('rErr',msg);btn.disabled=false;btn.textContent='Create My Slambook ğŸŒ¸';return;
  }

  setTokens(reg.data.access_token,reg.data.refresh_token);
  const uid=reg.data.user.id;

  /* Unique slambook token */
  const token=Math.random().toString(36).slice(2,8)+Math.random().toString(36).slice(2,8);

  /* Insert profile â€” include email so login by username works */
  const prof=await sbFetch('/rest/v1/profiles',{
    method:'POST',
    headers:{'Prefer':'return=representation'},
    body:JSON.stringify({id:uid,username,email:email.toLowerCase(),slambook_token:token})
  });
  if(!prof.ok){showErr('rErr','Could not save profile. Try again.');btn.disabled=false;btn.textContent='Create My Slambook ğŸŒ¸';return;}

  currentProfile={...(prof.data[0]||{}),username,slambook_token:token};
  goDash();
  btn.disabled=false;btn.textContent='Create My Slambook ğŸŒ¸';
}

async function handleLogin(){
  const btn=document.getElementById('lBtn');
  const username=document.getElementById('lUser').value.trim();
  const password=document.getElementById('lPass').value;
  if(!username||!password){showErr('lErr','Please fill in all fields');return;}
  btn.disabled=true;btn.textContent='Openingâ€¦ ğŸ“–';

  /* Look up email by username from profiles */
  const pRes=await sbFetch(`/rest/v1/profiles?username=ilike.${encodeURIComponent(username)}&select=id,username,slambook_token,email`);
  if(!pRes.ok||!pRes.data.length){showErr('lErr','Username not found');btn.disabled=false;btn.textContent='Open My Slambook ğŸ“–';return;}

  const profData=pRes.data[0];
  const email=profData.email;
  if(!email){showErr('lErr','Account error â€” please re-register');btn.disabled=false;btn.textContent='Open My Slambook ğŸ“–';return;}

  /* Sign in with email + password */
  const sig=await sbFetch('/auth/v1/token?grant_type=password',{
    method:'POST',body:JSON.stringify({email,password})
  });
  if(!sig.ok){showErr('lErr','Incorrect password');btn.disabled=false;btn.textContent='Open My Slambook ğŸ“–';return;}

  setTokens(sig.data.access_token,sig.data.refresh_token);
  currentProfile=profData;
  goDash();
  btn.disabled=false;btn.textContent='Open My Slambook ğŸ“–';
}

async function handleLogout(){
  await sbFetch('/auth/v1/logout',{method:'POST'}).catch(()=>{});
  clearTokens();
  currentUser=null; currentProfile=null;
  showPage('authPage');
}

/* â•â• DASHBOARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function goDash(){
  const uname = currentProfile.username;
  document.getElementById('av').textContent=uname[0].toUpperCase();
  document.getElementById('unameDisp').textContent=uname;
  const link=location.protocol+'//'+location.host+'/fill.html?s='+currentProfile.slambook_token;
  document.getElementById('shareLink').textContent=link;
  showPage('dashPage');
  loadResponses();
}
function copyLink(){
  const l=document.getElementById('shareLink').textContent;
  navigator.clipboard.writeText(l).then(()=>toast('ğŸ“‹ Copied! Share away~')).catch(()=>toast('Link: '+l));
}
async function loadResponses(){
  if(!currentProfile) return;
  const r = await sbFetch(`/rest/v1/responses?owner_id=eq.${currentProfile.id}&order=timestamp.asc`);
  if(r.ok) renderCards(r.data);
}

const STIX=['ğŸŒ¸','ğŸ’Œ','âœ¨','ğŸ¦‹','ğŸŒˆ','â­','ğŸ’–','ğŸ€','ğŸ“','ğŸŒ™'];
const COLORS=['var(--c1)','var(--c2)','var(--c3)','var(--c4)','var(--c5)'];
function renderCards(list){
  const g=document.getElementById('rGrid');
  if(!list||!list.length){g.innerHTML=`<div class="empty-state"><span class="em">ğŸ“­</span><h4>No slams yet!</h4><p>Share your link and wait for the love~</p></div>`;return;}
  g.innerHTML='';
  [...list].reverse().forEach((r,i)=>{
    const stk=STIX[i%STIX.length];
    const d=document.createElement('div');
    d.className='r-card';
    d.style.borderTopColor=COLORS[i%COLORS.length];
    d.style.animationDelay=(i*.06)+'s';
    const ts = r.timestamp ? new Date(r.timestamp).toLocaleDateString('en-GB',{day:'numeric',month:'short',year:'numeric'}) : 'just now';
    d.innerHTML=`<span class="stk">${stk}</span>
      <div class="rn">${esc(r.full_name||'Anonymous')}</div>
      <div class="rk">${r.nickname?'"'+esc(r.nickname)+'"':''}</div>
      <div class="rp">${esc((r.message||r.fav_quote||'').substring(0,85))}${(r.message||r.fav_quote||'').length>85?'â€¦':''}</div>
      <div><span class="rb">${esc(r.zodiac||'âœ¨')}</span></div>
      <div class="rt">${ts}</div>
      <button class="del-btn" title="Delete">ğŸ—‘ï¸</button>`;
    d.addEventListener('click',e=>{if(!e.target.closest('.del-btn'))openModal(r,stk);});
    d.querySelector('.del-btn').addEventListener('click',e=>{e.stopPropagation();confirmDelete(r.entry_id,r.full_name,d);});
    g.appendChild(d);
  });
}

/* â•â• DELETE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function confirmDelete(eid,name,el){
  document.getElementById('confirmName').textContent=name||'this slam';
  document.getElementById('confirmBox').classList.add('open');
  document.getElementById('confirmYesBtn').onclick=async()=>{document.getElementById('confirmBox').classList.remove('open');await doDelete(eid,el);};
  document.getElementById('confirmNoBtn').onclick=()=>document.getElementById('confirmBox').classList.remove('open');
}
async function doDelete(eid,el){
  el.classList.add('deleting');
  const r = await sbFetch(`/rest/v1/responses?entry_id=eq.${eid}`,{method:'DELETE'});
  if(!r.ok){el.classList.remove('deleting');toast('âŒ Could not delete.');return;}
  setTimeout(()=>{
    el.remove();
    if(!document.getElementById('rGrid').querySelector('.r-card'))
      document.getElementById('rGrid').innerHTML=`<div class="empty-state"><span class="em">ğŸ“­</span><h4>No slams yet!</h4><p>Share your link and wait for the love~</p></div>`;
    toast('ğŸ—‘ï¸ Slam deleted!');
  },340);
}

/* â•â• MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function openModal(r,stk='ğŸŒ¸'){
  document.getElementById('mTitle').textContent=stk+' '+(r.full_name||'Anonymous');
  document.getElementById('mBody').innerHTML=buildModal(r);
  document.getElementById('modal').classList.add('open');
}
function closeModal(){document.getElementById('modal').classList.remove('open');}
function maybeClose(e){if(e.target===document.getElementById('modal'))closeModal();}
function qr(label,val){const v=val&&String(val).trim()?`<div class="qv">${esc(val)}</div>`:`<div class="qv empty">not answered</div>`;return `<div class="qrow"><div class="ql">${label}</div>${v}</div>`;}
function rf(label,val){return `<div class="rfi"><div class="ql">${label}</div><div class="qv" style="font-size:1rem">${val?esc(val):'â€”'}</div></div>`;}
function buildModal(r){return `
<div class="qs"><div class="qs-title">ğŸ’Œ Basic Details</div>${qr('Full Name',r.full_name)}${qr('Nickname',r.nickname)}${qr('Date of Birth',r.dob)}${qr('Zodiac',r.zodiac)}${qr('Contact',r.contact)}</div>
<div class="qs"><div class="qs-title">â­ Favorites</div>${qr('Color',r.fav_color)}${qr('Food',r.fav_food)}${qr('Movie/Series',r.fav_movie)}${qr('Singer/Band',r.fav_singer)}${qr('Actor/Actress',r.fav_actor)}${qr('Place',r.fav_place)}${qr('Subject',r.fav_subject)}${qr('Hobby',r.fav_hobby)}${qr('Season',r.fav_season)}${qr('Quote',r.fav_quote)}</div>
<div class="qs"><div class="qs-title">ğŸ¯ Dreams & Goals</div>${qr('Biggest Goal',r.goal)}${qr('Dream Job',r.dream_job)}${qr('In 10 Yearsâ€¦',r.in_10_years)}${qr('One Thing to Achieve',r.want_to_achieve)}</div>
<div class="qs"><div class="qs-title">ğŸ’­ About Me</div>${qr('3 Words',r.three_words)}${qr('Biggest Fear',r.biggest_fear)}${qr('Strength',r.strength)}${qr('Hidden Talent',r.hidden_talent)}${qr('Embarrassing Moment',r.embarrassing_moment)}${qr('Biggest Crush ğŸ˜',r.crush)}</div>
<div class="qs"><div class="qs-title">ğŸ‘€ About Us</div>${qr('First Impression',r.first_impression)}${qr('What Changed',r.what_changed)}${qr('Fav Memory',r.fav_memory)}${qr('Like Most',r.like_most)}${qr('Annoys Me ğŸ˜…',r.annoys_me)}${qr('Secret',r.secret_between_us)}${qr('If We Were a Movieâ€¦',r.movie_title)}</div>
<div class="qs"><div class="qs-title">ğŸµ Just For You</div>${qr('Song Dedicated to You',r.dedicate_song)}${qr('A Line From That Song',r.song_line)}${qr('Our Theme Song',r.theme_song)}</div>
<div class="qs"><div class="qs-title">ğŸ”¥ Rapid Fire</div><div class="rf-grid">${rf('â˜• or ğŸµ',r.coffee_tea)}${rf('ğŸŒ™ or â˜€ï¸',r.night_day)}${rf('ğŸ’• or ğŸ’°',r.love_money)}${rf('ğŸ“ or ğŸ’¬',r.call_text)}${rf('â›°ï¸ or ğŸ–ï¸',r.mountains_beach)}${rf('ğŸ™ˆ or ğŸ¦‹',r.intro_extro)}</div></div>
<div class="qs"><div class="qs-title">ğŸ’– One Last Thing</div>${qr('A Message For You',r.message)}<div class="qrow"><div class="ql">Will You Remember Me?</div><div class="qv" style="color:var(--accent);font-size:1.3rem">${esc(r.remember_me||'Yes! Always ğŸ’–')}</div></div></div>`;}

/* â•â• INIT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(async()=>{
  if(!sbToken) return;
  /* Verify token still valid */
  const me = await sbFetch('/auth/v1/user');
  if(!me.ok){ clearTokens(); return; }
  /* Load profile */
  const uid = me.data.id;
  const pRes = await sbFetch(`/rest/v1/profiles?id=eq.${uid}&select=id,username,slambook_token`);
  if(pRes.ok && pRes.data.length>0){
    currentProfile = pRes.data[0];
    goDash();
  }
})();
</script>
</body>
</html>